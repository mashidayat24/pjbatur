
<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aplikasi Pencarian PDF</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .pdf-container {
            height: 80vh;
            margin-top: 1rem;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            overflow: hidden;
        }
        .result-item:hover {
            background-color: #f3f4f6;
            transform: translateY(-1px);
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        #searchResults {
            max-height: 300px;
            overflow-y: auto;
        }
        .loading-spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #3498db;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .pdf-controls {
            background: #f8fafc;
            padding: 8px 16px;
            border-bottom: 1px solid #e5e7eb;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .search-highlight {
            background-color: #fef3c7;
            padding: 2px 4px;
            border-radius: 3px;
            font-weight: bold;
        }
        .file-info {
            font-size: 0.875rem;
            color: #6b7280;
            margin-top: 4px;
        }
        .result-item {
            transition: all 0.2s ease;
            border-radius: 6px;
            margin: 2px;
        }
        .no-pdf-support {
            background: #f9fafb;
            border: 2px dashed #d1d5db;
            border-radius: 8px;
            padding: 2rem;
            text-align: center;
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <div class="container mx-auto px-4 py-8">
        <!-- Header -->
        <div class="text-center mb-8">
            <img src="https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/f72c0540-fa73-44b9-b30a-0f4bc894f637.png" alt="Logo aplikasi pencarian dokumen PDF dengan ikon magnifying glass dan file PDF modern" class="mx-auto h-10" />
            <h1 class="text-4xl font-bold text-gray-800 mt-4">Pencarian Dokumen PDF</h1>
            <p class="text-gray-600 mt-2">Temukan, baca, dan jelajahi dokumen PDF dengan mudah</p>
        </div>

        <div class="max-w-6xl mx-auto">
            <!-- Search Section -->
            <div class="bg-white rounded-lg shadow-md p-6 mb-6">
                <div class="flex flex-col sm:flex-row gap-2">
                    <input 
                        type="text" 
                        id="searchInput" 
                        placeholder="Masukkan kata kunci untuk mencari dokumen..." 
                        class="flex-grow px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                    >
                    <button 
                        id="searchButton" 
                        class="bg-blue-600 text-white px-8 py-3 rounded-lg hover:bg-blue-700 transition duration-200 font-medium"
                    >
                        <span id="searchButtonText">Cari</span>
                        <div id="searchLoading" class="loading-spinner mx-auto hidden"></div>
                    </button>
                </div>

                <!-- Search Results -->
                <div id="searchResults" class="mt-4 hidden">
                    <h3 class="font-semibold text-gray-700 mb-3">Hasil Pencarian:</h3>
                    <div id="resultsContainer" class="space-y-2">
                        <!-- Hasil pencarian akan muncul di sini -->
                    </div>
                </div>
            </div>

            <!-- PDF Viewer Section -->
            <div id="pdfViewerContainer" class="bg-white rounded-lg shadow-md hidden">
                <div class="pdf-controls">
                    <div>
                        <h2 id="pdfTitle" class="font-semibold text-lg text-gray-800"></h2>
                        <p id="pdfInfo" class="text-sm text-gray-500"></p>
                    </div>
                    <div class="flex items-center gap-3">
                        <button 
                            id="downloadButton" 
                            class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700 transition text-sm"
                        >
                            Download
                        </button>
                        <button 
                            id="fullscreenButton" 
                            class="bg-gray-600 text-white px-4 py-2 rounded hover:bg-gray-700 transition text-sm"
                        >
                            Fullscreen
                        </button>
                        <button 
                            id="closeButton" 
                            class="text-gray-500 hover:text-gray-700 text-xl font-bold px-2"
                            title="Tutup PDF"
                        >
                            Ã—
                        </button>
                    </div>
                </div>
                
                <div id="pdfContent" class="pdf-container">
                    <div id="pdfLoading" class="flex items-center justify-center h-full hidden">
                        <div class="text-center">
                            <div class="loading-spinner mx-auto mb-4"></div>
                            <p class="text-gray-600">Memuat dokumen PDF...</p>
                        </div>
                    </div>
                    
                    <embed id="pdfViewer" src="" type="application/pdf" width="100%" height="100%" class="hidden">
                    
                    <div id="pdfFallback" class="no-pdf-support hidden">
                        <img src="https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/718052f1-12d2-40e9-88f4-86b2914ce23e.png" alt="Ikon peringatan bahwa browser tidak mendukung PDF viewer dengan tampilan modern" class="mx-auto mb-4" />
                        <h3 class="text-lg font-semibold text-gray-700 mb-2">Browser tidak mendukung PDF Viewer</h3>
                        <p class="text-gray-600 mb-4">Gunakan browser modern atau download file untuk melihat dokumen</p>
                        <button id="downloadFallback" class="bg-blue-600 text-white px-6 py-2 rounded hover:bg-blue-700 transition">
                            Download PDF
                        </button>
                    </div>
                </div>
            </div>

            <!-- Empty State -->
            <div id="emptyState" class="text-center py-16">
                <img src="https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/6262b517-2b4d-489b-a358-7615f740ad70.png" alt="Ilustrasi pencarian dokumen menampilkan folder besar dengan kaca pembesar dan ikon PDF bertebaran dalam gaya flat design modern" class="mx-auto mb-6" />
                <h3 class="text-xl font-semibold text-gray-700 mb-2">Mulai Pencarian Dokumen</h3>
                <p class="text-gray-500 max-w-md mx-auto">Gunakan kolom pencarian di atas untuk menemukan dokumen PDF. Ketik kata kunci yang ingin Anda cari dalam dokumen.</p>
            </div>
        </div>
    </div>

    <script>
        // Database simulasi dengan informasi file PDF
        const pdfDatabase = [
            { 
                filename: "panduan-penggunaan.pdf", 
                displayName: "Panduan Penggunaan Aplikasi",
                description: "Manual lengkap untuk menggunakan aplikasi",
                fileSize: "2.3 MB",
                uploadDate: "2024-01-15",
                matches: ["panduan", "pengguna", "aplikasi", "manual", "dokumentasi", "cara", "penggunaan", "tutorial"]
            },
            { 
                filename: "laporan-keuangan-2023.pdf", 
                displayName: "Laporan Keuangan Tahunan 2023",
                description: "Laporan finansial dan analisis keuangan tahun 2023",
                fileSize: "5.7 MB",
                uploadDate: "2024-02-01",
                matches: ["laporan", "keuangan", "2023", "tahun", "finansial", "analisis", "budget", "pendapatan"]
            },
            { 
                filename: "panduan-installasi.pdf", 
                displayName: "Panduan Installasi Software",
                description: "Langkah-langkah instalasi dan konfigurasi sistem",
                fileSize: "1.8 MB",
                uploadDate: "2024-01-20",
                matches: ["panduan", "installasi", "instalasi", "software", "aplikasi", "setup", "konfigurasi", "sistem"]
            },
            { 
                filename: "kebijakan-privasi.pdf", 
                displayName: "Kebijakan Privasi dan Keamanan Data",
                description: "Dokumen kebijakan perlindungan data pengguna",
                fileSize: "980 KB",
                uploadDate: "2024-01-10",
                matches: ["kebijakan", "privasi", "data", "perlindungan", "pengguna", "keamanan", "gdpr", "policy"]
            },
            { 
                filename: "prosedur-operasional.pdf", 
                displayName: "Standar Operasional Prosedur",
                description: "SOP untuk berbagai aktivitas operasional",
                fileSize: "3.2 MB",
                uploadDate: "2024-02-05",
                matches: ["prosedur", "operasional", "sop", "standar", "aktivitas", "workflow", "proses", "panduan"]
            }
        ];

        // DOM Elements
        const searchInput = document.getElementById('searchInput');
        const searchButton = document.getElementById('searchButton');
        const searchButtonText = document.getElementById('searchButtonText');
        const searchLoading = document.getElementById('searchLoading');
        const searchResults = document.getElementById('searchResults');
        const resultsContainer = document.getElementById('resultsContainer');
        const pdfViewerContainer = document.getElementById('pdfViewerContainer');
        const pdfViewer = document.getElementById('pdfViewer');
        const pdfTitle = document.getElementById('pdfTitle');
        const pdfInfo = document.getElementById('pdfInfo');
        const pdfContent = document.getElementById('pdfContent');
        const pdfLoading = document.getElementById('pdfLoading');
        const pdfFallback = document.getElementById('pdfFallback');
        const emptyState = document.getElementById('emptyState');
        const closeButton = document.getElementById('closeButton');
        const downloadButton = document.getElementById('downloadButton');
        const downloadFallback = document.getElementById('downloadFallback');
        const fullscreenButton = document.getElementById('fullscreenButton');

        let currentPdfFile = null;

        // Fungsi untuk highlight kata kunci dalam teks
        function highlightKeyword(text, keyword) {
            if (!keyword.trim()) return text;
            const regex = new RegExp(`(${keyword})`, 'gi');
            return text.replace(regex, '<span class="search-highlight">$1</span>');
        }

        // Fungsi pencarian dengan animasi loading
        async function searchPDFs(keyword) {
            // Show loading
            searchButtonText.classList.add('hidden');
            searchLoading.classList.remove('hidden');
            searchButton.disabled = true;

            // Simulate API delay
            await new Promise(resolve => setTimeout(resolve, 500));

            if (!keyword.trim()) {
                resetToEmptyState();
                return;
            }

            const results = pdfDatabase.filter(pdf => 
                pdf.displayName.toLowerCase().includes(keyword.toLowerCase()) ||
                pdf.description.toLowerCase().includes(keyword.toLowerCase()) ||
                pdf.matches.some(match => match.toLowerCase().includes(keyword.toLowerCase()))
            );

            displayResults(results, keyword);

            // Hide loading
            searchButtonText.classList.remove('hidden');
            searchLoading.classList.add('hidden');
            searchButton.disabled = false;
        }

        // Reset ke empty state
        function resetToEmptyState() {
            searchResults.classList.add('hidden');
            pdfViewerContainer.classList.add('hidden');
            emptyState.classList.remove('hidden');
            searchButtonText.classList.remove('hidden');
            searchLoading.classList.add('hidden');
            searchButton.disabled = false;
        }

        // Menampilkan hasil pencarian
        function displayResults(results, keyword) {
            resultsContainer.innerHTML = '';

            if (results.length === 0) {
                resultsContainer.innerHTML = `
                    <div class="p-6 text-center text-gray-500 bg-gray-50 rounded-lg">
                        <img src="https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/cf488485-f268-4cd9-9371-19a7d217b447.png" alt="Ikon tidak ada hasil pencarian dengan folder kosong dan tanda tanya" class="mx-auto mb-3" />
                        <p class="font-medium">Tidak ada hasil ditemukan</p>
                        <p class="text-sm">Coba gunakan kata kunci yang berbeda</p>
                    </div>
                `;
                searchResults.classList.remove('hidden');
                emptyState.classList.add('hidden');
                return;
            }

            results.forEach((result, index) => {
                const resultItem = document.createElement('div');
                resultItem.className = 'result-item p-4 border border-gray-200 cursor-pointer hover:border-blue-300 bg-white rounded-lg';
                
                const highlightedTitle = highlightKeyword(result.displayName, keyword);
                const highlightedDesc = highlightKeyword(result.description, keyword);
                
                resultItem.innerHTML = `
                    <div class="flex items-start justify-between">
                        <div class="flex-grow">
                            <h4 class="font-semibold text-gray-800 mb-1">${highlightedTitle}</h4>
                            <p class="text-gray-600 text-sm mb-2">${highlightedDesc}</p>
                            <div class="file-info flex items-center gap-4">
                                <span>ðŸ“„ ${result.fileSize}</span>
                                <span>ðŸ“… ${new Date(result.uploadDate).toLocaleDateString('id-ID')}</span>
                            </div>
                        </div>
                        <div class="ml-4">
                            <button class="bg-blue-100 text-blue-700 px-3 py-1 rounded text-sm hover:bg-blue-200 transition">
                                Buka
                            </button>
                        </div>
                    </div>
                `;
                
                resultItem.onclick = () => openPDF(result);
                resultsContainer.appendChild(resultItem);
            });

            searchResults.classList.remove('hidden');
            emptyState.classList.add('hidden');
        }

        // Membuka dan menampilkan PDF
        async function openPDF(fileData) {
            currentPdfFile = fileData;
            
            // Show PDF container
            pdfViewerContainer.classList.remove('hidden');
            searchResults.classList.add('hidden');
            emptyState.classList.add('hidden');
            
            // Update PDF info
            pdfTitle.textContent = fileData.displayName;
            pdfInfo.textContent = `${fileData.fileSize} â€¢ Diupload: ${new Date(fileData.uploadDate).toLocaleDateString('id-ID')}`;
            
            // Show loading
            pdfLoading.classList.remove('hidden');
            pdfViewer.classList.add('hidden');
            pdfFallback.classList.add('hidden');
            
            // Simulate loading delay
            await new Promise(resolve => setTimeout(resolve, 800));
            
            try {
                // Set PDF source
                const pdfPath = `database/${fileData.filename}`;
                pdfViewer.src = pdfPath;
                
                // Hide loading and show PDF
                pdfLoading.classList.add('hidden');
                pdfViewer.classList.remove('hidden');
                
                // Check if PDF loaded successfully after a delay
                setTimeout(() => {
                    if (!pdfViewer.offsetHeight || pdfViewer.offsetHeight < 100) {
                        showPDFFallback();
                    }
                }, 2000);
                
            } catch (error) {
                console.error('Error loading PDF:', error);
                showPDFFallback();
            }
        }

        // Menampilkan fallback jika PDF tidak bisa dimuat
        function showPDFFallback() {
            pdfLoading.classList.add('hidden');
            pdfViewer.classList.add('hidden');
            pdfFallback.classList.remove('hidden');
        }

        // Menutup PDF viewer
        function closePDFViewer() {
            pdfViewer.src = '';
            currentPdfFile = null;
            pdfViewerContainer.classList.add('hidden');
            
            // Show search results if they exist
            if (resultsContainer.children.length > 0) {
                searchResults.classList.remove('hidden');
            } else {
                emptyState.classList.remove('hidden');
            }
        }

        // Download PDF
        function downloadPDF() {
            if (currentPdfFile) {
                const link = document.createElement('a');
                link.href = `database/${currentPdfFile.filename}`;
                link.download = currentPdfFile.filename;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            }
        }

        // Fullscreen PDF
        function toggleFullscreen() {
            if (pdfViewer.requestFullscreen) {
                pdfViewer.requestFullscreen();
            } else if (pdfViewer.webkitRequestFullscreen) {
                pdfViewer.webkitRequestFullscreen();
            } else if (pdfViewer.msRequestFullscreen) {
                pdfViewer.msRequestFullscreen();
            }
        }

        // Event Listeners
        searchButton.addEventListener('click', () => {
            searchPDFs(searchInput.value);
        });

        searchInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                searchPDFs(searchInput.value);
            }
        });

        searchInput.addEventListener('input', (e) => {
            if (e.target.value.trim() === '') {
                resetToEmptyState();
            }
        });

        closeButton.addEventListener('click', closePDFViewer);
        downloadButton.addEventListener('click', downloadPDF);
        downloadFallback.addEventListener('click', downloadPDF);
        fullscreenButton.addEventListener('click', toggleFullscreen);

        // Keyboard shortcuts
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape' && !pdfViewerContainer.classList.contains('hidden')) {
                closePDFViewer();
            }
        });
    </script>
</body>
</html>

